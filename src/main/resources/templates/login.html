<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Kakao Login Test</title>
</head>
<body>
<h1>Kakao 로그인 테스트</h1>

<!-- 1. 카카오 로그인 -->
<button onclick="loginWithKakao()">Kakao Login</button>

<!-- 2. 유저 정보 가져오기 -->
<button onclick="getUserInfo()">유저 정보</button>

<!-- 3. 알림 동의 변경 -->
<button onclick="updateNotification(true)">알림 동의 ON</button>
<button onclick="updateNotification(false)">알림 동의 OFF</button>

<!-- 4. 회원 탈퇴 -->
<button onclick="deleteUser()">회원 탈퇴</button>

<!-- 5. 로그아웃 -->
<button onclick="logout()">로그아웃</button>

<script>
    function loginWithKakao() {
        window.location.href = "http://localhost:8080/oauth2/authorization/kakao";
    }

    function getUserInfo() {
        fetch("http://localhost:8080/api/users/info", {
            method: "GET",
            credentials: "include"
        })
        .then(res => res.json())
        .then(data => alert(JSON.stringify(data)))
        .catch(err => console.error(err));
    }

    function updateNotification(isSubscribed) {
        fetch("http://localhost:8080/api/users/notification", {
            method: "PATCH",
            headers: { "Content-Type": "application/json" },
            credentials: "include",
            body: JSON.stringify({ subscribed: isSubscribed })
        })
        .then(res => res.json())
        .then(data => alert(JSON.stringify(data)))
        .catch(err => console.error(err));
    }

    function deleteUser() {
        fetch("http://localhost:8080/api/users/delete", {
            method: "DELETE",
            credentials: "include"
        })
        .then(res => res.json())
        .then(data => alert(JSON.stringify(data)))
        .catch(err => console.error(err));
    }

    function logout() {
        fetch("http://localhost:8080/api/users/logout", {
            method: "POST",
            credentials: "include"
        })
        .then(res => res.json())
        .then(data => alert(JSON.stringify(data)))
        .catch(err => console.error(err));
    }
</script>
</body>
</html>

